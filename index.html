<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Limitless IDE v2.0</title>
    
    <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>

    <style>
        :root { --accent: #4caf50; --ai-purple: #bb86fc; }
        body { margin: 0; background: #0b0b0b; font-family: 'SF Mono', monospace; display: flex; height: 100vh; color: #fff; }
        
        #left-panel { width: 50%; display: flex; flex-direction: column; border-right: 1px solid #222; }
        #tabs { background: #111; display: flex; padding: 10px; gap: 10px; border-bottom: 1px solid #222; }
        .tab { color: #666; font-size: 12px; cursor: pointer; padding: 5px 10px; border: 1px solid transparent; transition: 0.2s; }
        .tab.active { color: var(--accent); border: 1px solid var(--accent); }
        
        #editor { flex: 1; background: #0b0b0b; color: #d4d4d4; border: none; padding: 20px; font-size: 16px; outline: none; resize: none; line-height: 1.5; }
        
        #right-panel { width: 50%; background: #000; position: relative; }
        #preview { width: 100%; height: 100%; border: none; background: #fff; display: block; }
        
        /* Overlays for Terminal and AI */
        .overlay { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #000; padding: 20px; box-sizing: border-box; overflow-y: auto; }
        #ai-log { color: var(--ai-purple); font-size: 14px; }
        #linux-term { color: #eee; }

        .controls { position: absolute; top: 15px; right: 15px; z-index: 1000; display: flex; gap: 10px; }
        button { background: rgba(0,0,0,0.8); border: 1px solid var(--accent); color: var(--accent); padding: 8px 15px; cursor: pointer; font-size: 12px; font-weight: bold; }
        button.ai-btn { border-color: var(--ai-purple); color: var(--ai-purple); }
    </style>
</head>
<body>

    <div id="left-panel">
        <div id="tabs">
            <div id="html-tab" class="tab active" onclick="setMode('HTML')">HTML/JS</div>
            <div id="python-tab" class="tab" onclick="setMode('Python')">PYTHON</div>
            <div id="linux-tab" class="tab" onclick="setMode('Linux')">LINUX</div>
            <div id="swift-tab" class="tab" onclick="setMode('Swift')">SWIFT</div>
        </div>
        <textarea id="editor" spellcheck="true" placeholder=""></textarea>
    </div>

    <div id="right-panel">
        <div class="controls">
            <button class="ai-btn" onclick="triggerAI()">AI ASSIST</button>
            <button onclick="runCode()">RUN</button>
        </div>
        
        <iframe id="preview"></iframe>
        <div id="linux-term" class="overlay">root@system:~# <span id="l-out"></span><br><input type="text" id="l-in" style="background:none;border:none;color:#fff;outline:none;width:80%"></div>
        <div id="ai-log" class="overlay"></div>
    </div>

    <script>
        let mode = 'HTML';
        let pyodide;

        async function init() { pyodide = await loadPyodide(); }
        init();

        function setMode(m) {
            mode = m;
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(m.toLowerCase() + '-tab').classList.add('active');
            document.querySelectorAll('.overlay').forEach(o => o.style.display = 'none');
            if (m === 'Linux') document.getElementById('linux-term').style.display = 'block';
        }

        async function runCode() {
            const code = document.getElementById('editor').value;
            const preview = document.getElementById('preview').contentWindow.document;
            if (mode === 'HTML') {
                preview.open(); preview.write(code); preview.close();
            } else if (mode === 'Python') {
                preview.open();
                preview.write(`<body style="background:#000;color:#4caf50;padding:20px;font-family:monospace;"><pre id="o"></pre></body>`);
                try {
                    pyodide.runPython(`import sys, io; sys.stdout = io.StringIO()`);
                    await pyodide.runPythonAsync(code);
                    preview.getElementById('o').innerText = pyodide.runPython("sys.stdout.getvalue()");
                } catch(e) { preview.getElementById('o').innerText = e; }
                preview.close();
            }
        }

        function triggerAI() {
            const aiView = document.getElementById('ai-log');
            aiView.style.display = 'block';
            aiView.innerHTML = `[ANALYZING ${mode} CODE...]<br><br>> System check complete.<br>> Suggestion: Ensure your logic loops are closed.<br>> Optimization: Ready to refactor on command.`;
        }
    </script>
</body>
</html>
